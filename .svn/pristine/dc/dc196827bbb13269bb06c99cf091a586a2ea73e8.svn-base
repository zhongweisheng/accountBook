var currentPage=1;var pages;var userId=DES3.decrypt(localStorage.getItem("userId"));var userType=localStorage.getItem("userType");if(userType==1){$(".leftContent > div:nth-child(8)> p:nth-child(6)").addClass("left_active");$(".leftContent > div:nth-child(7)").addClass("left_active")}else{$(".leftContent > div:nth-child(8)> p:nth-child(4)").addClass("left_active");$(".leftContent > div:nth-child(7)").addClass("left_active")}$(document).on("mouseover","#accountRemark",function(){$(this).siblings("div").slideDown(100)});$(document).on("mouseout","#accountRemark",function(){$(this).siblings("div").css("display","none")});getData();initPaging();$(".page").on("click",function(){currentPage=$(".activP").text();getData()});function initPaging(){$(".page").page({leng:pages,activeClass:"activP"})}$(document).on("click","#submit",function(){var d=$("#trueName").val();var c=$("#phone").val();var e=$("#idCard").val();var f=$("#cardNumber").val();var b=$("#company").val();var h=$("#remark").val();if(!d){$("#trueName").nextAll("p").css("display","inline-block");return}if(!c){$("#phone").nextAll("p").css("display","inline-block");return}var g={};g.userId=userId;g.staffType=2;g.trueName=d;g.phone=c;g.idCard=e;g.cardNumber=f;g.company=b;g.remark=h;var a=Restful.post("bsinventorystaff",g);if(a){if(a.success){getData();initPaging();$(".registerModel").fadeOut(200)}else{alert("买粮人添加失败")}}else{alert("账号别处登录或者网络有问题")}});function getData(){var f={};f.currentPage=currentPage;f.userId=userId;f.staffType=2;var c=Restful.post("bsinventorystaff/list",f);if(c.success){var d=c.dataList;var e=$("#salePerson-list").html();var a=Template7.compile(e);var b=a({salePerson:d});$("#list").html(b);pages=Math.ceil(c.total/10)}else{$("#list").html("");$("#list").html('<tr><td colspan="9"><div style="width: 100%;height: 400px;line-height: 100px;font-size: 30px;text-align: center;margin:0 auto;color: #c1c1c1;text-shadow: #999999;">暂无数据</div>')}}$(document).on("click","#add",function(){$(".register-form input,textarea").val("");$("#addP").fadeIn(200)});$(document).on("click","#cencel",function(){$(".registerModel").fadeOut(200);$(".register-form input,textarea").val("")});$(document).on("click","#deletebtn",function(){var c=$(this).attr("data-id");var b=confirm("确定删除本条记录?");if(b){var a=Restful.deletestaff("bsinventorystaff/"+c);if(a){if(a.success){getData();initPaging()}else{alert("买粮人删除失败")}}else{alert("账号别处登录或者网络有问题")}}});var staffId;$(document).on("click","#editbtn",function(){$("#edit").fadeIn(200);var b=$(this).attr("data-id");staffId=b;var a=Restful.get("bsinventorystaff/"+b);if(a){$("#trueName-edit").val(a.trueName);$("#phone-edit").val(a.phone);$("#idCard-edit").val(a.idCard);$("#cardNumber-edit").val(a.cardNumber);$("#company-edit").val(a.company);$("#remark-edit").val(a.remark)}});$(document).on("click","#editSubmit",function(){var d=$("#trueName-edit").val();var g=$("#phone-edit").val();var a=$("#idCard-edit").val();var j=$("#cardNumber-edit").val();var h=$("#company-edit").val();var e=$("#remark-edit").val();if(!d){$("#trueName").nextAll("p").css("display","inline-block");return}if(!g){$("#phone").nextAll("p").css("display","inline-block");return}var c={};c.userId=userId;c.staffType=2;c.trueName=d;c.phone=g;c.idCard=a;c.cardNumber=j;c.company=h;c.remark=e;var b={};b.id=staffId;b.userId=userId;b.staffType=2;b.phone=$("#phone-edit").val();var f=Restful.post("bsinventorystaff/isExist",b);if(!f){var i=Restful.post("bsinventorystaff/"+staffId,c);if(i){if(i.success){getData();initPaging();$("#edit").fadeOut(200)}else{alert("买粮人编辑失败")}}else{alert("账号别处登录或者网络有问题")}}else{alert("手机号已存在")}});$(document).on("click","#editCencel",function(){$("#edit").fadeOut(200)});