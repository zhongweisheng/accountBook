(function(a){if(typeof define==="function"&&(define.amd||define.cmd)&&!jQuery){define(["jquery"],a)}else{if(typeof module==="object"&&module.exports){module.exports=function(b,c){if(c===undefined){if(typeof window!=="undefined"){c=require("jquery")}else{c=require("jquery")(b)}}a(c);return c}}else{a(jQuery)}}}(function(a){a.support.cors=true;a.fn.citys=function(h,e){if(typeof h=="function"){e=h;h={}}else{h=h||{};e=e||function(){}}var d=200;var f=new Date();a("#province").on("focus",function(){f=new Date()}).on("blur",function(i){if(new Date().getTime()-f.getTime()<d){$$("#province").focus()}});var c=new Date();a("#city").on("focus",function(){c=new Date()}).on("blur",function(i){if(new Date().getTime()-c.getTime()<d){$$("#city").focus()}});var g={dataUrl:"accountData/json/citys.json",dataType:"json",provinceField:"province",cityField:"city",areaField:"area",code:0,province:0,city:0,area:0,required:true,nodata:"hidden",onChange:function(){}};var b=a.extend({},g,h);return this.each(function(){var k={};var l=a(this);var m=l.find('select[name="'+b.provinceField+'"]'),j=l.find('select[name="'+b.cityField+'"]'),i=l.find('select[name="'+b.areaField+'"]');a.ajax({url:b.dataUrl,type:"GET",crossDomain:true,dataType:b.dataType,jsonpCallback:"jsonp_location",success:function(r){var n,t,q,p;if(b.code){var u=b.code-b.code%10000;if(r[u]){b.province=u}u=b.code-(b.code%10000?b.code%100:b.code);if(r[u]){b.city=u}u=b.code%100?b.code:0;if(r[u]){b.area=u}}var o=function(){n={},t={},q={};p=false;for(var v in r){if(!(v%10000)){n[v]=r[v];if(b.required&&!b.province){if(b.city&&!(b.city%10000)){b.province=b.city}else{b.province=v}}else{if(r[v].indexOf(b.province)>-1){b.province=isNaN(b.province)?v:b.province}}}else{var w=v-b.province;if(b.province&&w>0&&w<10000){if(!(v%100)){p=true;t[v]=r[v];if(b.required&&!b.city){b.city=v}else{if(r[v].indexOf(b.city)>-1){b.city=isNaN(b.city)?v:b.city}}}else{if(w>9000){t[v]=r[v];if(b.required&&!b.city){b.city=v}else{if(r[v].indexOf(b.city)>-1){b.city=isNaN(b.city)?v:b.city}}}else{if(p){var x=v-b.city;if(b.city&&x>0&&x<100){q[v]=r[v];if(b.required&&!b.area){b.area=v}else{if(r[v].indexOf(b.area)>-1){b.area=isNaN(b.area)?v:b.area}}}}else{t[v]=r[v];if(b.area){b.city=b.area;b.area=""}if(b.required&&!b.city){b.city=v}else{if(r[v].indexOf(b.city)>-1){b.city=isNaN(b.city)?v:b.city}}}}}}}}};var s={province:function(){m.empty();if(!b.required){m.append('<option value="-1">省</option>')}for(var v in n){m.append('<option value="'+v+'">'+n[v]+"</option>")}if(b.province){m.val(b.province)}this.city()},city:function(){j.empty();if(!b.required){j.append('<option value="-1"> 市</option>')}if(b.nodata=="disabled"){j.prop("disabled",a.isEmptyObject(t))}else{if(b.nodata=="hidden"){j.css("display",a.isEmptyObject(t)?"none":"")}}for(var v in t){j.append('<option value="'+v+'">'+t[v]+"</option>")}if(b.city){j.val(b.city)}this.area()},area:function(){i.empty();if(!p){i.css("display","none")}else{i.css("display","");if(!b.required){i.append('<option value="-1">县</option>')}if(b.nodata=="disabled"){i.prop("disabled",a.isEmptyObject(q))}else{if(b.nodata=="hidden"){i.css("display",a.isEmptyObject(q)?"none":"")}}for(var v in q){i.append('<option value="'+v+'">'+q[v]+"</option>")}if(b.area){i.val(b.area)}}}};k.getInfo=function(){var v={direct:!p,province:r[b.province]||"",city:r[b.city]||"",area:r[b.area]||"",code:b.area||b.city||b.province};return v};m.on("change",function(){b.province=a(this).val();b.city=0;b.area=0;o();s.city();b.onChange(k.getInfo())});j.on("change",function(){b.city=a(this).val();b.area=0;if(b.city=="-1"){b.city=b.province}o();s.area();b.onChange(k.getInfo())});i.on("change",function(){b.area=a(this).val();if(b.area=="-1"){b.area=b.city}b.onChange(k.getInfo())});o();s.province();if(b.code){b.onChange(k.getInfo())}e(k)}})})}}));