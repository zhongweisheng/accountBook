var depotLen;var userId=DES3.decrypt(localStorage.getItem("userId"));$(".leftContent > div:nth-child(8)> p:nth-child(2)").addClass("left_active");$(".leftContent > div:nth-child(7)").addClass("left_active");getData();$(document).on("click","#submit",function(){var d=$("#depotName").val();var c=$("#depotCapacity").val();var b=$("#depotLocation").val();if(!d){$("#depotName").nextAll("p").css("display","inline-block");return}if(!c){$("#depotCapacity").nextAll("p").css("display","inline-block");return}if(!b){$("#depotLocation").nextAll("p").css("display","inline-block");return}var e={};e.ownerId=userId;e.name=d;e.storageCapacity=c;e.address=b;var a=Restful.post("bsinventorydepot",e);if(a){if(a.success){getData();$(".registerModel").fadeOut(200)}else{alert("粮库添加失败")}}else{alert("账号别处登录或者网络有问题")}});$(document).on("click","#upsubmit",function(){var d=$("#updepotName").val();var c=$("#updepotCapacity").val();var b=$("#updepotLocation").val();if(!d){$("#depotName").nextAll("p").css("display","inline-block");return}if(!c){$("#depotCapacity").nextAll("p").css("display","inline-block");return}if(!b){$("#depotLocation").nextAll("p").css("display","inline-block");return}var e={};e.ownerId=userId;e.updateData=1;e.name=d;e.storageCapacity=c;e.address=b;var a=Restful.post("bsinventorydepot",e);if(a){if(a.success){getData();$(".registerModel").fadeOut(200)}else{alert("粮库添加失败")}}else{alert("账号别处登录或者网络有问题")}});function getData(){var f={};f.userId=userId;var c=Restful.post("bsinventorydepot/list",f);if(c&&c.success){var d=c.dataList;var e=$("#salePerson-list").html();var a=Template7.compile(e);var b=a({salePerson:d});$("#list").html(b);depotLen=$("#list tr").length;if(depotLen>5){$("#add").addClass("disable")}else{$("#add").removeClass("disable")}}else{$("#list").html("");$("#list").html('<tr><td colspan="5"><div style="width: 100%;height: 400px;line-height: 100px;font-size: 30px;text-align: center;margin:0 auto;color: #c1c1c1;text-shadow: #999999;">暂无数据</div>');$(".register-form input,textarea").val("");$("#update").fadeIn(200)}}$(document).on("click","#add",function(){if(depotLen>5){alert("添加数达到上限")}else{$(".register-form input,textarea").val("");$("#addP").fadeIn(200)}});$(document).on("click","#cencel",function(){$(".registerModel").fadeOut(200);$(".register-form input,textarea").val("")});$(document).on("click","#deletebtn",function(){if(depotLen==1){$("#deletebtn").addClass("disable");alert("不可删除，至少留一个库");return}else{$("#deletebtn").removeClass("disable");var c=$(this).attr("data-id");var b=confirm("粮库删除后不可恢复，确定删除?");if(b){var a=Restful.deletestaff("bsinventorydepot/"+c);if(a){if(a.success){getData()}else{alert("粮库删除失败")}}else{alert("账号别处登录或者网络有问题")}}}});var depotId;$(document).on("click","#editbtn",function(){$("#edit").fadeIn(200);var b=$(this).attr("data-id");depotId=b;var a=Restful.get("bsinventorydepot/"+b);if(a){$("#depotName-edit").val(a.name);$("#depotCapacity-edit").val(a.storageCapacity);$("#depotLocation-edit").val(a.address)}});$(document).on("click","#editSubmit",function(){var d=$("#depotName-edit").val();var c=$("#depotCapacity-edit").val();var b=$("#depotLocation-edit").val();if(!d){$("#depotName").nextAll("p").css("display","inline-block");return}if(!c){$("#depotCapacity").nextAll("p").css("display","inline-block");return}if(!b){$("#depotLocation").nextAll("p").css("display","inline-block");return}var e={};e.ownerId=userId;e.name=d;e.storageCapacity=c;e.address=b;var a=Restful.post("bsinventorydepot/"+depotId,e);if(a){if(a.success){getData();$("#edit").fadeOut(200)}else{alert("粮库编辑失败")}}else{alert("账号别处登录或者网络有问题")}});$(document).on("click","#editCencel",function(){$("#edit").fadeOut(200)});