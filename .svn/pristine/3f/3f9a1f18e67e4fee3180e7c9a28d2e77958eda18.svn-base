var isZhou=false;$(".leftContent > div:nth-child(1)").addClass("left_active");var grainType=2;var searchType=1;var timeType=1;var depot="0";var ymval,xmval,sdval;var xData,outData,hasData,xDataz,outDataz,hasDataz;var yinPriceData,yinPriceMax,yinPriceMin,yinPriceInt;var yinAmountData,yinAmountMax,yinAmountMin,yinAmountInt;var hasAmountData,hasAmountMax,hasAmountMin,hasAmountInt;var outPriceData,outPriceMax,outPriceMin,outPriceInt;var outAmoountData,outAmoountMax,outAmoountMin,outAmoountInt;var inAmountName="收粮量(吨)";var hasAmountName="库存(吨)";var outAmountName="售粮量(吨)";var colors=["#5793f3","#d14a61","#675bba"];var colorsLine=["#d14a61","#675bba"];getData();var depotre=Restful.post("bsinventorydepot/getDepots",{userId:userId});if(depotre){var html='<option value="0">全部</option>';for(var i=0,len=depotre.length;i<len;i++){html+=' <option value="'+depotre[i].id+'">'+depotre[i].name+"</option>"}$(".depot").html("").append(html)}function getData(){var c={};c.userId=DES3.decrypt(localStorage.getItem("userId"));c.depotId=depot;c.searchType=timeType;c.grainType=grainType;c.type=searchType;var h=Restful.post("bsinventoryrecord/findRecordDao",c);if(h){var f=h.dataList;var a=$("#table-list").html();var j=Template7.compile(a);var g=j({table1:f});$("#list").html(g);var e=h.dataList[0];ymval=e.ymPercentage;xmval=e.xmPercentage;sdval=e.sdPercentage;xData=e.xData;hasData=e.hasData;outData=e.outData;xDataz=e.xDataz;hasDataz=e.hasDataz;outDataz=e.outDataz;yinPriceData=e.yinPriceData;yinAmountData=e.yinAmountData;hasAmountData=e.hasAmountData;outPriceData=e.outPriceData;outAmoountData=e.outAmoountData;var m=echarts.init(document.getElementById("c-inLine"));var l=echarts.init(document.getElementById("c-inBar"));var k=echarts.init(document.getElementById("c-hasBar"));var d=echarts.init(document.getElementById("c-outLine"));var b=echarts.init(document.getElementById("c-outBar"));inLineoption={grid:{left:"15%"},title:{text:"入库价格",textStyle:{color:"#5d91f4"},x:"center"},legend:{data:["收粮价(元/斤)"],y:30},color:colorsLine,tooltip:{trigger:"axis",formatter:function(o){var n;if(isZhou){n="<p>"+o[0].axisValue+"</br>"+xDataz[o[0].dataIndex]+"</br>"+o[0].seriesName+":"+o[0].data+"</p>"}else{n="<p>"+o[0].axisValue+"</br>"+o[0].seriesName+":"+o[0].data+"</p>"}return n}},xAxis:[{type:"category",data:xData,axisLabel:{rotate:45},axisPointer:{type:"shadow"}}],yAxis:[{type:"value",name:"收粮价(元/斤)",boundaryGap:["10%","10%"],splitLine:{show:false},axisLabel:{formatter:"{value}"}}],series:[{name:"收粮价(元/斤)",type:"line",itemStyle:{normal:{label:{show:true}}},data:yinPriceData}]};inBaroption={grid:{left:"15%"},color:colors,tooltip:{trigger:"axis",formatter:function(o){var n;if(isZhou){n="<p>"+o[0].axisValue+"</br>"+xDataz[o[0].dataIndex]+"</br>"+o[0].seriesName+":"+o[0].data+"</p>"}else{n="<p>"+o[0].axisValue+"</br>"+o[0].seriesName+":"+o[0].data+"</p>"}return n}},title:{text:"入库数量",textStyle:{color:"#5d91f4"},x:"center"},legend:{data:[inAmountName],y:30},xAxis:[{type:"category",data:xData,axisLabel:{rotate:45},axisPointer:{type:"shadow"}}],yAxis:[{type:"value",name:inAmountName,boundaryGap:["10%","10%"],splitLine:{show:false},axisLabel:{formatter:"{value}"}}],series:[{name:inAmountName,type:"bar",barMaxWidth:50,itemStyle:{normal:{label:{show:false,position:"top",color:"#000"}}},data:yinAmountData}]};hasOption={grid:{left:"15%"},title:{text:"库存数量",textStyle:{color:"#5d91f4"},x:"center"},color:colors,tooltip:{trigger:"axis",formatter:function(o){var n;if(isZhou){n="<p>"+o[0].axisValue+"</br>"+hasDataz[o[0].dataIndex]+"</br>"+o[0].seriesName+":"+o[0].data+"</p>"}else{n="<p>"+o[0].axisValue+"</br>"+o[0].seriesName+":"+o[0].data+"</p>"}return n}},legend:{data:[hasAmountName],y:30},xAxis:[{type:"category",data:hasData,axisLabel:{rotate:45},axisPointer:{type:"shadow"}}],yAxis:[{type:"value",name:hasAmountName,boundaryGap:["10%","10%"],splitLine:{show:false},axisLabel:{formatter:"{value}"}}],series:[{name:hasAmountName,type:"bar",barMaxWidth:50,itemStyle:{normal:{label:{show:false,position:"top",color:"#000"}}},data:hasAmountData}]};outLineoption={grid:{left:"15%"},title:{text:"出库价格",textStyle:{color:"#5d91f4"},x:"center"},color:colorsLine,tooltip:{trigger:"axis",formatter:function(o){var n;if(isZhou){n="<p>"+o[0].axisValue+"</br>"+outDataz[o[0].dataIndex]+"</br>"+o[0].seriesName+":"+o[0].data+"</p>"}else{n="<p>"+o[0].axisValue+"</br>"+o[0].seriesName+":"+o[0].data+"</p>"}return n}},legend:{data:["售粮价(元/斤)"],y:30},xAxis:[{type:"category",data:outData,axisLabel:{rotate:45},axisPointer:{type:"shadow"}}],yAxis:[{type:"value",name:"售粮价(元/斤)",boundaryGap:["10%","10%"],splitLine:{show:false},axisLabel:{formatter:"{value}"}}],series:[{name:"售粮价(元/斤)",type:"line",itemStyle:{normal:{label:{show:true}}},data:outPriceData}]};outBaroption={grid:{left:"15%"},color:colors,title:{text:"出库数量",textStyle:{color:"#5d91f4"},x:"center"},tooltip:{trigger:"axis",formatter:function(o){var n;if(isZhou){n="<p>"+o[0].axisValue+"</br>"+outDataz[o[0].dataIndex]+"</br>"+o[0].seriesName+":"+o[0].data+"</p>"}else{n="<p>"+o[0].axisValue+"</br>"+o[0].seriesName+":"+o[0].data+"</p>"}return n}},legend:{data:[outAmountName],y:30},xAxis:[{type:"category",data:outData,axisLabel:{rotate:45},axisPointer:{type:"shadow"}}],yAxis:[{type:"value",name:outAmountName,boundaryGap:["10%","10%"],splitLine:{show:false},axisLabel:{formatter:"{value}"}}],series:[{name:outAmountName,type:"bar",barMaxWidth:50,itemStyle:{normal:{label:{show:false,position:"top",color:"#000"}}},data:outAmoountData}]};if(!yinAmountData){$("#c-inBar").html('<div style="width: 100%;height: 100px;line-height: 100px;font-size: 20px;text-align: center;margin:0 auto;color: #c1c1c1;text-shadow: #999999;">暂无数据</div>')}else{l.setOption(inBaroption)}if(!yinPriceData){$("#c-inLine").html('<div style="width: 100%;height: 100px;line-height: 100px;font-size: 20px;text-align: center;margin:0 auto;color: #c1c1c1;text-shadow: #999999;">暂无数据</div>')}else{m.setOption(inLineoption)}if(!hasAmountData){$("#c-hasBar").html('<div style="width: 100%;height: 100px;line-height: 100px;font-size: 20px;text-align: center;margin:0 auto;color: #c1c1c1;text-shadow: #999999;">暂无数据</div>')}else{k.setOption(hasOption)}if(!outPriceData){$("#c-outLine").html('<div style="width: 100%;height: 100px;line-height: 100px;font-size: 20px;text-align: center;margin:0 auto;color: #c1c1c1;text-shadow: #999999;">暂无数据</div>')}else{d.setOption(outLineoption)}if(!outAmoountData){$("#c-outBar").html('<div style="width: 100%;height: 100px;line-height: 100px;font-size: 20px;text-align: center;margin:0 auto;color: #c1c1c1;text-shadow: #999999;">暂无数据</div>')}else{b.setOption(outBaroption)}}else{$("#list").html("");$("#list").html('<tr><td colspan="4"><div style="width: 100%;height: 100px;line-height: 100px;font-size: 20px;text-align: center;margin:0 auto;color: #c1c1c1;text-shadow: #999999;">暂无数据</div>')}}$("#timeType").on("change",function(){timeType=$("#timeType").val();if(timeType==2){isZhou=true}else{isZhou=false}grainType=$("#grainType").val();getData()});$("#searchType").on("change",function(){searchType=$("#searchType").val();if(searchType!=1){inAmountName="收粮金额(元)";hasAmountName="库存金额(元)";outAmountName="售粮金额(元)"}else{inAmountName="收粮量(吨)";hasAmountName="库存(吨)";outAmountName="售粮量(吨)"}getData();getDeport()});$("#depot").on("change",function(){depot=$("#depot").val();getData()});