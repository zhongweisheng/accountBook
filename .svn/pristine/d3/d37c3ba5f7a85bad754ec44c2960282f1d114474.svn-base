var depotLen;var userId=DES3.decrypt(localStorage.getItem("userId"));$(".leftContent > div:nth-child(8)> p:nth-child(2)").addClass("left_active");$(".leftContent > div:nth-child(7)").addClass("left_active");getData();$(document).on("click","#submit",function(){var d=$("#depotName").val();var c=$("#depotCapacity").val();var b=$("#depotLocation").val();if(!d){$("#depotName").nextAll("p").css("display","inline-block");return}if(!c){$("#depotCapacity").nextAll("p").css("display","inline-block");return}if(!b){$("#depotLocation").nextAll("p").css("display","inline-block");return}var e={};e.userId=userId;e.trueName=d;e.phone=c;e.idCard=b;var a=Restful.post("bsinventorystaff",e);if(a){if(a.success){getData();$(".registerModel").fadeOut(200)}else{alert("送粮人添加失败")}}else{alert("账号别处登录或者网络有问题")}});function getData(){var f={};f.userId=userId;f.staffType=1;var c=Restful.post("bsinventorystaff/list",f);if(c.success){var d=c.dataList;var e=$("#salePerson-list").html();var a=Template7.compile(e);var b=a({salePerson:d});$("#list").html(b);depotLen=$("#list tr").length;if(depotLen>6){$("#add").addClass("disable")}}else{$("#list").html("");$("#list").html('<tr><td colspan="9"><div style="width: 100%;height: 400px;line-height: 100px;font-size: 30px;text-align: center;margin:0 auto;color: #c1c1c1;text-shadow: #999999;">暂无数据</div>')}}$(document).on("click","#add",function(){if(depotLen>6){alert("添加数达到上限")}else{$(".register-form input,textarea").val("");$("#addP").fadeIn(200);$(".addressSelete").citys({required:false,nodata:"disabled",onChange:function(a){console.log(a);locationText=a.province+a.city+a.area;locationNum=a.code}})}});$(document).on("click","#cencel",function(){$(".registerModel").fadeOut(200);$(".register-form input,textarea").val("")});$(document).on("click","#deletebtn",function(){if(depotLen==1){$("#deletebtn").addClass("disable");alert("不可删除，至少留一个库");return}else{$("#deletebtn").removeClass("disable");var c=$(this).attr("data-id");var b=confirm("确定删除本条记录?");if(b){var a=Restful.deletestaff("bsinventorystaff/"+c);if(a){if(a.success){getData()}else{alert("送粮人删除失败")}}else{alert("账号别处登录或者网络有问题")}}}});var staffId;$(document).on("click","#editbtn",function(){$("#edit").fadeIn(200);var b=$(this).attr("data-id");staffId=b;var a=Restful.get("bsinventorystaff/"+b);if(a){$("#depotName-edit").val(a.trueName);$("#depotCapacity-edit").val(a.phone);$("#depotLocation-edit").val(a.idCard)}$(".addressSelete").citys({required:false,nodata:"disabled",onChange:function(c){console.log(c);locationText=c.province+c.city+c.area;locationNum=c.code}})});$(document).on("click","#editSubmit",function(){var e=$("#depotName-edit").val();var c=$("#depotCapacity-edit").val();var b=$("#depotLocation-edit").val();if(!e){$("#depotName").nextAll("p").css("display","inline-block");return}if(!c){$("#depotCapacity").nextAll("p").css("display","inline-block");return}if(!b){$("#depotLocation").nextAll("p").css("display","inline-block");return}var f={};f.userId=userId;f.trueName=e;f.phone=c;f.idCard=b;var d=Restful.post("bsinventorystaff/isExist",telParams);if(!d){var a=Restful.post("bsinventorystaff/"+staffId,f);if(a){if(a.success){getData();$("#edit").fadeOut(200)}else{alert("送粮人编辑失败")}}else{alert("账号别处登录或者网络有问题")}}else{alert("手机号已存在")}});$(document).on("click","#editCencel",function(){$("#edit").fadeOut(200)});