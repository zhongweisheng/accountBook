if(navigator.userAgent.indexOf("Firefox")>=0){$("input[type=number]").on("DOMMouseScroll",function(){return false})}else{$("input[type=number]").on("mousewheel",function(){return false})}var userId=DES3.decrypt(localStorage.getItem("userId"));var isNewPerson,driverstate,locationNum,locationText;$(".leftContent > div:nth-child(4) > p:nth-child(4)").addClass("left_active");$(".leftContent > div:nth-child(3)").addClass("left_active");$(".child").eq(1).css("display","block");$(".noComplete").on("click",function(){location.href="noOutForm.html"});$("#deduction").on("focus",function(){if($("#deduction").val()==0||$("#deduction").val()==""){$("#deduction").val("")}});var depotNum=4;var mwidth=depotNum*400;$(".depot-slider").width(mwidth+"px");if(depotNum==1){$(".num1").show().siblings().hide()}else{if(depotNum==2){$(".num2").show().siblings().hide()}else{$(".num3").show().siblings().hide();var sl=parseInt($(".depot-slider").css("left"));$(".next").on("click",function(){var a=sl+mwidth;if(a==800){alert("已经是最后一个库");$(".next").css("background","#ddd")}else{sl=sl-800;$(".depot-slider").css("left",sl+"px");$(".pre").css("background","#aaa")}});$(".pre").on("click",function(){if(sl>=0){alert("已经是第一个库");$(".pre").css("background","#ddd")}else{sl=sl+800;$(".depot-slider").css("left",sl+"px");$(".next").css("background","#aaa")}})}}$(".depot-slider").on("click",".depot",function(){$(this).addClass("depot-active").removeClass("depot").siblings(".depot-active").addClass("depot").removeClass("depot-active")});var select2Array=[],driverArray=[],licensePlate=["无"],phoneArray=[""],driverPhone=[""];var person=Restful.post("bsinventorystaff/list",{userId:userId,staffType:2,pageSize:1000});if(person){if(person.success){var personArr=person.dataList;select2Array.push({id:0,text:"请选择",phone:""});$.each(personArr,function(a,b){select2Array.push({id:b.staffId,text:b.trueName,phone:b.phone});phoneArray.push(b.phone)})}else{select2Array.push({id:0,text:"无",phone:""})}}$("#buyPerson").select2({data:select2Array,templateResult:formatState});var driver=Restful.post("bsinventorystaff/list",{userId:userId,staffType:3,pageSize:1000});if(driver){if(driver.success){var driverArr=driver.dataList;driverArray.push({id:0,text:"请选择",phone:""});$.each(driverArr,function(a,b){driverArray.push({id:b.staffId,text:b.trueName,phone:b.phone});licensePlate.push(b.licensePlate);driverPhone.push(b.phone)})}else{driverArray.push({id:0,text:"无",phone:""})}}$("#driver").select2({data:driverArray,templateResult:formatState});$("#driver").on("change",function(){var a=$("#driver").children("option:selected").index();$("#licensePlate").val(licensePlate[a])});function formatState(b){if(!b.id){return b.text}var a="";if(b.text!="请选择"){a=$('<span style="display: inline-block;height: 2rem;">姓名: '+b.text+"</br><span>手机号:"+b.phone+"</span></span>")}else{a=$('<span style="display: inline-block;">'+b.text+"</span>")}return a}function getNum(){var a=Restful.post("bsInventoryTemporary/queryCount",{userId:userId,recordType:2});if(a&&a.success){$(".finishNum").html(a.retcode)}else{$(".finishNum").html(0);alert("获取未完成出库单数失败，稍后再试")}}getNum();$(function(){for(var d=0;d<24;d++){var a=d;if(a<10){a="0"+d}$("#hour").append('<option value="'+a+'">'+a+"</option>")}for(var d=0;d<60;d++){var a=d;if(a<10){a="0"+d}$("#minute").append('<option value="'+a+'">'+a+"</option>")}var f=new Date();var e=f.getFullYear();var g=f.getMonth()+1;if(g<10){g="0"+g}var c=f.getDate();if(c<10){c="0"+c}var b=f.getHours();if(b<10){b="0"+b}var h=f.getMinutes();if(h<10){h="0"+h}nowDate=e+"-"+g+"-"+c;$("#date").val(nowDate)});function Calculation(){var b=$("#grossWeightOut").val();var a=$("#tareWeightOut").val();var d=$("#unitPrice").val();var e=$("#deduction").val();var c=b-a-e;c=c.toFixed(2);var f=c*d*2;f=f.toFixed(2);$("#netWeightOut").val(c);$("#moneyOut").val(f)}$("#grossWeightOut").keyup(function(){Calculation()});$("#tareWeightOut").keyup(function(){Calculation()});$("#unitPrice").keyup(function(){Calculation()});$("#deduction").keyup(function(){Calculation()});$("input:radio").change(function(){if($("input:radio:checked").val()==1){$(".grain").show();$(".notGrain").hide()}else{$(".notGrain").show();$(".grain").hide()}});$(".addressSelete").citys({required:false,nodata:"disabled",onChange:function(a){console.log(a);locationText=a.province+a.city+a.area;locationNum=a.code}});function checkForm(){var c=/^[1-9]\d*\.\d{0,2}|[1-9]\d*|0\.\d{0,2}|0$/;var g=/^[1-9]\d*\.\d{1}|[1-9]\d*|0\.\d{1}$/;var h=/^[1-9]\d*\.\d{0,3}|[1-9]\d*|0\.\d{0,3}$/;var f=$("input:radio:checked").val();var d=$("#date").val();var b=$("#grossWeightOut").val();var a=$("#tareWeightOut").val();var e=b-a;if(e<0){alert("皮重不能大于毛重");return false}if($("#addPerson").val()!=""&&$("#phone").val()==""){alert("请填写买粮人手机号");return false}if($("#phone").val()!=""&&$("#addPerson").val()==""){alert("请填写买粮人姓名");return false}if($("#addDriver").val()!=""&&$("#driverPhone").val()==""){alert("请填写司机手机号");return false}if($("#driverPhone").val()!=""&&$("#addDriver").val()==""){alert("请填写司机姓名");return false}if($("#grossWeightOut").val()==""||$("#grossWeightOut").val()<=0){$("#grossWeightOut").siblings("p").html("请填写毛重后提交");return false}else{$("#grossWeightOut").siblings("p").html("")}if($("#tareWeightOut").val()==""||$("#tareWeightOut").val()<0){$("#tareWeightOut").siblings("p").html("请填写皮重后提交");return false}else{$("#tareWeightOut").siblings("p").html("")}if($("#unitPrice").val()==""||$("#unitPrice").val()<0){$("#unitPrice").siblings("p").html("请填写单价后提交");return false}else{$("#unitPrice").siblings("p").html("")}if(!c.test($("#grossWeightOut").val())){$("#grossWeightOut").siblings("p").html("毛重最多八位整数俩位小数");return false}else{$("#grossWeightOut").siblings("p").html("")}if(!c.test($("#tareWeightOut").val())){$("#tareWeightOut").siblings("p").html("皮重最多八位整数俩位小数");return false}else{$("#tareWeightOut").siblings("p").html("")}if(!h.test($("#unitPrice").val())){$("#unitPrice").siblings("p").html("单价最多三位整数三位小数");return false}else{$("#unitPrice").siblings("p").html("")}if(f==1){if($("#waterxm").val()!=""&&!g.test($("#waterxm").val())){$("#waterxm").siblings("p").html("水分最多俩位整数一位小数");return false}else{$("#waterxm").siblings("p").html("")}if($("#buwanshanlixm").val()!=""&&!g.test($("#buwanshanlixm").val())){$("#buwanshanlixm").siblings("p").html("不完善粒最多俩位整数一位小数");return false}else{$("#buwanshanlixm").siblings("p").html("")}if($("#impurityxm").val()!=""&&!g.test($("#impurityxm").val())){$("#impurityxm").siblings("p").html("杂质最多俩位整数一位小数");return false}else{$("#impurityxm").siblings("p").html("")}}else{if($("#water").val()!=""&&!g.test($("#water").val())){$("#water").siblings("p").html("水分最多俩位整数一位小数");return false}else{$("#water").siblings("p").html("")}if($("#meibian").val()!=""&&!g.test($("#meibian").val())){$("#meibian").siblings("p").html("霉变最多俩位整数一位小数");return false}else{$("#meibian").siblings("p").html("")}if($("#buwanshanli").val()!=""&&!g.test($("#buwanshanli").val())){$("#buwanshanli").siblings("p").html("不完善粒最多俩位整数一位小数");return false}else{$("#buwanshanli").siblings("p").html("")}if($("#impurity").val()!=""&&!g.test($("#impurity").val())){$("#impurity").siblings("p").html("杂质最多俩位整数一位小数");return false}else{$("#impurity").siblings("p").html("")}}return true}$("#submit").on("click",function(){if(!checkForm()){return false}if($("#submit").hasClass("disable")){alert("不可重复提交");return}$("#submit").addClass("disable");var b=$("#date").val();var c={};var k=locationNum;var h=locationText;c.recordType=2;c.userId=userId;c.recordNumber=$("#recordNumber").text().replace("No.","");c.date=b;c.licensePlate=$("#licensePlate").val();var d=$("input:radio:checked").val();if(d==1){c.bulkDensity=$("#rongzhongxm").val();c.imperfectGrains=$("#buwanshanlixm").val();c.moistureContent=$("#waterxm").val();c.impurity=$("#impurityxm").val();c.productQuality=$("#qualityxm").val();c.remark=$("#remarkxm").val();if(c.productQuality!=null&&c.productQuality!=""&&c.productQuality*1>0){if(c.bulkDensity==null||c.bulkDensity==""){alert("请填写容重！");$("#submit").removeClass("disable");return false}if(c.productQuality*1==1){if(c.bulkDensity!=null&&c.bulkDensity!=""&&c.bulkDensity*1<790){alert("质量与容重不匹配，容重必须大于等于 790！");$("#submit").removeClass("disable");return false}}else{if(c.productQuality*1==2){if(c.bulkDensity!=null&&c.bulkDensity!=""&&c.bulkDensity*1<770||c.bulkDensity*1>790){alert("质量与容重不匹配，容重必须大于等于 770，小于790！");$("#submit").removeClass("disable");return false}}else{if(c.productQuality*1==3){if(c.bulkDensity!=null&&c.bulkDensity!=""&&c.bulkDensity*1<750||c.bulkDensity*1>770){alert("质量与容重不匹配，容重必须大于等于 750，小于770！");$("#submit").removeClass("disable");return false}}else{if(c.productQuality*1==4){if(c.bulkDensity!=null&&c.bulkDensity!=""&&c.bulkDensity*1<730||c.bulkDensity*1>750){alert("质量与容重不匹配，容重必须大于等于 730，小于750！");$("#submit").removeClass("disable");return false}}else{if(c.productQuality*1==5){if(c.bulkDensity!=null&&c.bulkDensity!=""&&c.bulkDensity*1<710||c.bulkDensity*1>730){alert("质量与容重不匹配，容重必须大于等于 710，小于730！");$("#submit").removeClass("disable");return false}}else{if(c.productQuality*1==6){if(c.bulkDensity!=null&&c.bulkDensity!=""&&c.bulkDensity*1>710){alert("质量与容重不匹配，容重必须小于 710！");$("#submit").removeClass("disable");return false}}}}}}}}}else{c.bulkDensity=$("#rongzhong").val();c.imperfectGrains=$("#buwanshanli").val();c.moistureContent=$("#water").val();c.impurity=$("#impurity").val();c.mildew=$("#meibian").val();c.productQuality=$("#quality").val();c.remark=$("#remark").val();if(d!=3){if(c.productQuality!=null&&c.productQuality!=""&&c.productQuality*1>0){if(c.bulkDensity==null||c.bulkDensity==""){alert("请填写容重！");$("#submit").removeClass("disable");return false}if(c.productQuality*1==1){if(c.bulkDensity!=null&&c.bulkDensity!=""&&c.bulkDensity*1<720){alert("质量与容重不匹配，容重必须大于等于 720！");$("#submit").removeClass("disable");return false}}else{if(c.productQuality*1==2){if(c.bulkDensity!=null&&c.bulkDensity!=""&&c.bulkDensity*1<685||c.bulkDensity*1>720){alert("质量与容重不匹配，容重必须大于等于 685，小于720！");$("#submit").removeClass("disable");return false}}else{if(c.productQuality*1==3){if(c.bulkDensity!=null&&c.bulkDensity!=""&&c.bulkDensity*1<650||c.bulkDensity*1>685){alert("质量与容重不匹配，容重必须大于等于 650，小于685！");$("#submit").removeClass("disable");return false}}else{if(c.productQuality*1==4){if(c.bulkDensity!=null&&c.bulkDensity!=""&&c.bulkDensity*1<620||c.bulkDensity*1>650){alert("质量与容重不匹配，容重必须大于等于 620，小于650！");$("#submit").removeClass("disable");return false}}else{if(c.productQuality*1==5){if(c.bulkDensity!=null&&c.bulkDensity!=""&&c.bulkDensity*1<590||c.bulkDensity*1>620){alert("质量与容重不匹配，容重必须大于等于 590，小于620！");$("#submit").removeClass("disable");return false}}else{if(c.productQuality*1==6){if(c.bulkDensity!=null&&c.bulkDensity!=""&&c.bulkDensity*1>590){alert("质量与容重不匹配，容重必须小于 590！");$("#submit").removeClass("disable");return false}}}}}}}}}}c.grainType=d;c.grossWeightOut=$("#grossWeightOut").val();c.tareWeightOut=$("#tareWeightOut").val();c.netWeightOut=$("#netWeightOut").val();c.unitPrice=$("#unitPrice").val();c.moneyOut=$("#moneyOut").val();c.deduction=$("#deduction").val();c.varietyType=$("#varietyType").val();c.packingType=$("#packingType").val();c.productionNiafe=$("#productionNiafe").val();c.smell=$("#smell").val();if(k==undefined){k=""}if(h==undefined){h=""}c.location=k;c.locationDesc=h;var g=false;if(driverstate){c.driverId=-100;c.driverName=$("#addDriver").val();c.driverPhone=$("#driverPhone").val();if(c.driverPhone!=null&&c.driverPhone!=""){var a={};a.userId=userId;a.staffType=3;a.phone=$("#driverPhone").val();g=Restful.post("bsinventorystaff/isExist",a)}}else{var f=$("#driver").val();if(f!=0){c.driverId=f;c.driverName=$("#driver").find("option:selected").text();var j=$("#driver").children("option:selected").index();c.driverPhone=driverPhone[j]}else{c.driverId="";c.driverName="";c.driverPhone=""}}if(!g){}else{alert("司机手机号已存在");$("#submit").removeClass("disable");return}if(isNewPerson){c.staffId=-100;c.staffName=$("#addPerson").val();c.staffPhone=$("#phone").val();if(c.staffPhone!=null&&c.staffPhone!=""){var a={};a.userId=userId;a.staffType=2;a.phone=$("#phone").val();g=Restful.post("bsinventorystaff/isExist",a)}}else{var e=$("#buyPerson").val();if(e!=0){c.staffId=e;c.staffName=$("#buyPerson").find("option:selected").text();var j=$("#buyPerson").children("option:selected").index();c.staffPhone=phoneArray[j]}else{c.staffId="";c.staffName="";c.staffPhone=""}}if((c.driverName==""||c.driverName==null)&&(c.staffName==""||c.staffName==null)){alert("司机和买粮人至少填一项！");$("#submit").removeClass("disable");return false}if(!g){var i=Restful.post("bsinventoryrecord/insert",c);if(i.success){alert("保存成功");window.location.href="outFormSuccess.html?id="+i.retcode+"&from=1"}else{alert("提交失败，稍后再试");$("#submit").removeClass("disable")}}else{alert("买粮人手机号已存在");$("#submit").removeClass("disable")}});function checkForms(){var a=/^[1-9]\d*\.\d{0,2}|[1-9]\d*|0\.\d{0,2}|0$/;var d=/^[1-9]\d*\.\d{1}|[1-9]\d*|0\.\d{1}$/;var e=/^[1-9]\d*\.\d{0,3}|[1-9]\d*|0\.\d{0,3}$/;var c=$("input:radio:checked").val();var b=$("#date").val();if($("#grossWeightOut").val()==""&&$("#tareWeightOut").val()==""){alert("毛重和皮重两项必填一项！");return false}if($("#grossWeightOut").val()!=null&&$("#grossWeightOut").val()!=""&&!a.test($("#grossWeightOut").val())){$("#grossWeightOut").siblings("p").html("毛重最多八位整数俩位小数");return false}else{$("#grossWeightOut").siblings("p").html("")}if($("#tareWeightOut").val()!=null&&$("#tareWeightOut").val()!=""&&!a.test($("#tareWeightOut").val())){$("#tareWeightOut").siblings("p").html("皮重最多八位整数俩位小数");return false}else{$("#tareWeightOut").siblings("p").html("")}if($("#addPerson").val()!=""&&$("#phone").val()==""){alert("请填写买粮人手机号");return false}if($("#phone").val()!=""&&$("#addPerson").val()==""){alert("请填写买粮人姓名");return false}if($("#addDriver").val()!=""&&$("#driverPhone").val()==""){alert("请填写司机手机号");return false}if($("#driverPhone").val()!=""&&$("#addDriver").val()==""){alert("请填写司机姓名");return false}if(!e.test($("#unitPrice").val())){}else{$("#unitPrice").siblings("p").html("")}if(c==1){if($("#waterxm").val()!=""&&!d.test($("#waterxm").val())){$("#waterxm").siblings("p").html("水分最多俩位整数一位小数");return false}else{$("#waterxm").siblings("p").html("")}if($("#buwanshanlixm").val()!=""&&!d.test($("#buwanshanlixm").val())){$("#buwanshanlixm").siblings("p").html("不完善粒最多俩位整数一位小数");return false}else{$("#buwanshanlixm").siblings("p").html("")}if($("#impurityxm").val()!=""&&!d.test($("#impurityxm").val())){$("#impurityxm").siblings("p").html("杂质最多俩位整数一位小数");return false}else{$("#impurityxm").siblings("p").html("")}}else{if($("#water").val()!=""&&!d.test($("#water").val())){$("#water").siblings("p").html("水分最多俩位整数一位小数");return false}else{$("#water").siblings("p").html("")}if($("#meibian").val()!=""&&!d.test($("#meibian").val())){$("#meibian").siblings("p").html("霉变最多俩位整数一位小数");return false}else{$("#meibian").siblings("p").html("")}if($("#buwanshanli").val()!=""&&!d.test($("#buwanshanli").val())){$("#buwanshanli").siblings("p").html("不完善粒最多俩位整数一位小数");return false}else{$("#buwanshanli").siblings("p").html("")}if($("#impurity").val()!=""&&!d.test($("#impurity").val())){$("#impurity").siblings("p").html("杂质最多俩位整数一位小数");return false}else{$("#impurity").siblings("p").html("")}}return true}$("#temporary").on("click",function(){if(!checkForms()){return false}if($("#temporary").hasClass("disable")){alert("不可重复提交");return}$("#temporary").addClass("disable");var b=$("#date").val();var c={};var k=locationNum;var h=locationText;c.recordType=2;c.userId=userId;c.recordNumber=$("#recordNumber").text().replace("No.","");c.date=b;c.licensePlate=$("#licensePlate").val();var d=$("input:radio:checked").val();if(d==1){c.bulkDensity=$("#rongzhongxm").val();c.imperfectGrains=$("#buwanshanlixm").val();c.moistureContent=$("#waterxm").val();c.impurity=$("#impurityxm").val();c.productQuality=$("#qualityxm").val();c.remark=$("#remarkxm").val();if(c.productQuality!=null&&c.productQuality!=""&&c.productQuality*1>0){if(c.bulkDensity==null||c.bulkDensity==""){alert("请填写容重！");$("#temporary").removeClass("disable");return false}if(c.productQuality*1==1){if(c.bulkDensity!=null&&c.bulkDensity!=""&&c.bulkDensity*1<790){alert("质量与容重不匹配，容重必须大于等于 790！");$("#temporary").removeClass("disable");return false}}else{if(c.productQuality*1==2){if(c.bulkDensity!=null&&c.bulkDensity!=""&&c.bulkDensity*1<770||c.bulkDensity*1>790){alert("质量与容重不匹配，容重必须大于等于 770，小于790！");$("#temporary").removeClass("disable");return false}}else{if(c.productQuality*1==3){if(c.bulkDensity!=null&&c.bulkDensity!=""&&c.bulkDensity*1<750||c.bulkDensity*1>770){alert("质量与容重不匹配，容重必须大于等于 750，小于770！");$("#temporary").removeClass("disable");return false}}else{if(c.productQuality*1==4){if(c.bulkDensity!=null&&c.bulkDensity!=""&&c.bulkDensity*1<730||c.bulkDensity*1>750){alert("质量与容重不匹配，容重必须大于等于 730，小于750！");$("#temporary").removeClass("disable");return false}}else{if(c.productQuality*1==5){if(c.bulkDensity!=null&&c.bulkDensity!=""&&c.bulkDensity*1<710||c.bulkDensity*1>730){alert("质量与容重不匹配，容重必须大于等于 710，小于730！");$("#temporary").removeClass("disable");return false}}else{if(c.productQuality*1==6){if(c.bulkDensity!=null&&c.bulkDensity!=""&&c.bulkDensity*1>710){alert("质量与容重不匹配，容重必须小于 710！");$("#temporary").removeClass("disable");return false}}}}}}}}}else{c.bulkDensity=$("#rongzhong").val();c.imperfectGrains=$("#buwanshanli").val();c.moistureContent=$("#water").val();c.impurity=$("#impurity").val();c.mildew=$("#meibian").val();c.productQuality=$("#quality").val();c.remark=$("#remark").val();if(d!=3){if(c.productQuality!=null&&c.productQuality!=""&&c.productQuality*1>0){if(c.bulkDensity==null||c.bulkDensity==""){alert("请填写容重！");$("#temporary").removeClass("disable");return false}if(c.productQuality*1==1){if(c.bulkDensity!=null&&c.bulkDensity!=""&&c.bulkDensity*1<720){alert("质量与容重不匹配，容重必须大于等于 720！");$("#temporary").removeClass("disable");return false}}else{if(c.productQuality*1==2){if(c.bulkDensity!=null&&c.bulkDensity!=""&&c.bulkDensity*1<685||c.bulkDensity*1>720){alert("质量与容重不匹配，容重必须大于等于 685，小于720！");$("#temporary").removeClass("disable");return false}}else{if(c.productQuality*1==3){if(c.bulkDensity!=null&&c.bulkDensity!=""&&c.bulkDensity*1<650||c.bulkDensity*1>685){alert("质量与容重不匹配，容重必须大于等于 650，小于685！");$("#temporary").removeClass("disable");return false}}else{if(c.productQuality*1==4){if(c.bulkDensity!=null&&c.bulkDensity!=""&&c.bulkDensity*1<620||c.bulkDensity*1>650){alert("质量与容重不匹配，容重必须大于等于 620，小于650！");$("#temporary").removeClass("disable");return false}}else{if(c.productQuality*1==5){if(c.bulkDensity!=null&&c.bulkDensity!=""&&c.bulkDensity*1<590||c.bulkDensity*1>620){alert("质量与容重不匹配，容重必须大于等于 590，小于620！");$("#temporary").removeClass("disable");return false}}else{if(c.productQuality*1==6){if(c.bulkDensity!=null&&c.bulkDensity!=""&&c.bulkDensity*1>590){alert("质量与容重不匹配，容重必须小于 590！");$("#temporary").removeClass("disable");return false}}}}}}}}}}c.grainType=d;c.grossWeightOut=$("#grossWeightOut").val();c.tareWeightOut=$("#tareWeightOut").val();c.netWeightOut=$("#netWeightOut").val();c.unitPrice=$("#unitPrice").val();c.moneyOut=$("#moneyOut").val();c.deduction=$("#deduction").val();c.varietyType=$("#varietyType").val();c.packingType=$("#packingType").val();c.productionNiafe=$("#productionNiafe").val();c.smell=$("#smell").val();if(k==undefined){k=""}if(h==undefined){h=""}c.location=k;c.locationDesc=h;var g=false;if(driverstate){c.driverId=-100;c.driverName=$("#addDriver").val();c.driverPhone=$("#driverPhone").val();if(c.driverPhone!=null&&c.driverPhone!=""){var a={};a.userId=userId;a.staffType=3;a.phone=$("#driverPhone").val();g=Restful.post("bsinventorystaff/isExist",a)}}else{var f=$("#driver").val();if(f!=0){c.driverId=f;c.driverName=$("#driver").find("option:selected").text();var j=$("#driver").children("option:selected").index();c.driverPhone=driverPhone[j]}else{c.driverId="";c.driverName="";c.driverPhone=""}}if(!g){}else{alert("司机手机号已存在");$("#temporary").removeClass("disable");return}if(c.driverName==""||c.driverName==null){alert("司机不能为空！");$("#temporary").removeClass("disable");return false}if(isNewPerson){c.staffId=-100;c.staffName=$("#addPerson").val();c.staffPhone=$("#phone").val();if(c.staffPhone!=null&&c.staffPhone!=""){var a={};a.userId=userId;a.staffType=2;a.phone=$("#phone").val();g=Restful.post("bsinventorystaff/isExist",a)}}else{var e=$("#buyPerson").val();if(e!=0){c.staffId=e;c.staffName=$("#buyPerson").find("option:selected").text();var j=$("#buyPerson").children("option:selected").index();c.staffPhone=phoneArray[j]}else{c.staffId="";c.staffName="";c.staffPhone=""}}if((c.driverName==""||c.driverName==null)&&(c.staffName==""||c.staffName==null)){alert("司机和买粮人至少填一项！");$("#temporary").removeClass("disable");return false}if(!g){var i=Restful.post("bsInventoryTemporary/insert",c);if(i.success){alert("暂存成功");window.location.href="noOutForm.html"}else{alert("提交失败，稍后再试");$("#temporary").removeClass("disable")}}else{alert("买粮人手机号已存在");$("#temporary").removeClass("disable")}});$(document).on("click","#cencel",function(){window.location.href="workIndex.html"});$(document).on("click","#printView",function(){var a="dataPrint.html?id="+$(this).attr("data-id");window.open(a)});$(document).on("click","#change-add",function(){isNewPerson=true;$("#addPerson").val("");$("#buyPerson").parent("label").css("display","none");$("#change-add").css("display","none");$("#addPerson").css("display","inline-block");$("#phone").css("display","inline-block");$("#change-sel").css("display","inline-block")});$(document).on("click","#change-sel",function(){isNewPerson=false;$("#buyPerson").css("width","60%").parent("label").css("display","");$("#change-add").css("display","inline-block");$("#addPerson").css("display","none");$("#phone").css("display","none");$("#change-sel").css("display","none")});$(document).on("click","#driver-add",function(){driverstate=true;$("#addDriver").val("");$("#driver").parent("label").css("display","none");$("#driver-add").css("display","none");$("#addDriver").css("display","inline-block");$("#driverPhone").css("display","inline-block");$("#driver-sel").css("display","inline-block")});$(document).on("click","#driver-sel",function(){driverstate=false;$("#driver").css("width","60%").parent("label").css("display","");$("#driver-add").css("display","inline-block");$("#addDriver").css("display","none");$("#driverPhone").css("display","none");$("#driver-sel").css("display","none")});$(document).on("blur",'.caption-article input:not([id="date"])',function(){if($(this).val()){$(this).nextAll("p").html("")}});function numberCtrl(c,d){var e=$(c).val();var f=e.split(".");if(f.length>1){if(f[1].length>d){f[1]=f[1].substring(0,d)}var b=f[0]+"."+f[1];$(c).val(b+"")}};