var userId=DES3.decrypt(localStorage.getItem("userId"));$(".leftContent > div:nth-child(8)> p:nth-child(2)").addClass("left_active");$(".leftContent > div:nth-child(7)").addClass("left_active");getData();$("#checkAll").change(function(){if($(this).prop("checked")==true){$("#select :checkbox").prop("checked",true)}else{$("#select :checkbox").prop("checked",false)}});$("#select :checkbox").on("change",function(){allchk()});function allchk(){var a=$("#select :checkbox").size();var b=0;$("#select :checkbox").each(function(){if($(this).prop("checked")==true){b++}});if(a==b){$("#checkAll").prop("checked",true)}else{$("#checkAll").prop("checked",false)}}$("#checkAll-edit").change(function(){if($(this).prop("checked")==true){$("#select-edit :checkbox").prop("checked",true)}else{$("#select-edit :checkbox").prop("checked",false)}});$("#select-edit :checkbox").on("change",function(){allchkEdit()});function allchkEdit(){var a=$("#select-edit :checkbox").size();var b=0;$("#select-edit :checkbox").each(function(){if($(this).prop("checked")==true){b++}});if(a==b){$("#checkAll-edit").prop("checked",true)}else{$("#checkAll-edit").prop("checked",false)}}$(document).on("click","#submit",function(){var e=new Array;$("#select :checkbox:checked").each(function(h){e[h]=$(this).attr("data-id")});var f=e.join(",");var d=$("#name").val();var b=$("#phone").val();var c=$("#password").val();if(!b){$("#phone").nextAll("p").css("display","inline-block");return}if(!c){$("#password").nextAll("p").css("display","inline-block");return}var g={};g.userId=userId;g.trueName=d;g.phone=b;g.idCard=c;g.vals=f;var a=Restful.post("bsinventorystaff",g);if(a){if(a.success){getData();$(".registerModel").fadeOut(200)}else{alert("送粮人添加失败")}}else{alert("账号别处登录或者网络有问题")}});function getData(){var f={};f.userId=userId;f.staffType=1;var c=Restful.post("bsinventorystaff/list",f);if(c.success){var d=c.dataList;var e=$("#salePerson-list").html();var a=Template7.compile(e);var b=a({salePerson:d});$("#list").html(b);if(c.total>30){$("#add").addClass("disable")}}else{$("#list").html("");$("#list").html('<tr><td colspan="9"><div style="width: 100%;height: 400px;line-height: 100px;font-size: 30px;text-align: center;margin:0 auto;color: #c1c1c1;text-shadow: #999999;">暂无数据</div>')}}$(document).on("click","#add",function(){if($("#add").hasClass("disable")){alert("添加员工数达到上限")}else{$(".register-form input,textarea").val("");$("#addP").fadeIn(200)}});$(document).on("click","#cencel",function(){$(".registerModel").fadeOut(200);$(".register-form input,textarea").val("")});$(document).on("click","#deletebtn",function(){$("#deletebtn").removeClass("disable");var c=$(this).attr("data-id");var b=confirm("确定删除本条记录?");if(b){var a=Restful.deletestaff("bsinventorystaff/"+c);if(a){if(a.success){getData()}else{alert("员工删除失败")}}else{alert("账号别处登录或者网络有问题")}}});var staffId;$(document).on("click","#editbtn",function(){$("#edit").fadeIn(200);var b=$(this).attr("data-id");staffId=b;var a=Restful.get("bsinventorystaff/"+b);if(a){$("#name-edit").val(a.trueName);$("#phone-edit").val(a.phone);$("#password-edit").val(a.idCard)}});$(document).on("click","#editSubmit",function(){var f=new Array;$("#select-edit :checkbox:checked").each(function(j){f[j]=$(this).attr("data-id")});var g=f.join(",");var d=$("#name-edit").val();var b=$("#phone-edit").val();var c=$("#password-edit").val();if(!b){$("#phone").nextAll("p").css("display","inline-block");return}if(!c){$("#password").nextAll("p").css("display","inline-block");return}var h={};h.userId=userId;h.trueName=d;h.phone=b;h.idCard=c;h.vals=g;var e=Restful.post("bsinventorystaff/isExist",telParams);if(!e){var a=Restful.post("bsinventorystaff/"+staffId,h);if(a){if(a.success){getData();$("#edit").fadeOut(200)}else{alert("员工编辑失败")}}else{alert("账号别处登录或者网络有问题")}}else{alert("手机号已存在")}});$(document).on("click","#editCencel",function(){$("#edit").fadeOut(200)});